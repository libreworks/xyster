<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>4.2. Action Helpers</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="xyster.controller.html" title="Chapter 4. Xyster_Controller">
<link rel="prev" href="xyster.controller.html" title="Chapter 4. Xyster_Controller">
<link rel="next" href="xyster.controller.plugins.html" title="4.3. Plugins">
<link rel="chapter" href="introduction.html" title="Chapter 1. Introduction to Xyster Framework">
<link rel="chapter" href="xyster.acl.html" title="Chapter 2. Xyster_Acl">
<link rel="chapter" href="xyster.collection.html" title="Chapter 3. Xyster_Collection">
<link rel="chapter" href="xyster.controller.html" title="Chapter 4. Xyster_Controller">
<link rel="chapter" href="xyster.data.html" title="Chapter 5. Xyster_Data">
<link rel="chapter" href="xyster.date.html" title="Chapter 6. Xyster_Date">
<link rel="chapter" href="xyster.enum.html" title="Chapter 7. Xyster_Enum">
<link rel="chapter" href="xyster.filter.html" title="Chapter 8. Xyster_Filter">
<link rel="chapter" href="xyster.orm.html" title="Chapter 9. Xyster_Orm">
<link rel="chapter" href="xyster.type.html" title="Chapter 10. Xyster_Type">
<link rel="chapter" href="xyster.validate.html" title="Chapter 11. Xyster_Validate">
<link rel="subsection" href="xyster.controller.actionhelpers.html#xyster.controller.actionhelpers.cache" title="4.2.1. Xyster_Controller_Action_Helper_Cache">
<link rel="subsection" href="xyster.controller.actionhelpers.html#xyster.controller.actionhelpers.file" title="4.2.2. Xyster_Controller_Action_Helper_File">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">4.2. Action Helpers</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="xyster.controller.html">Prev</a> </td>
<th width="60%" align="center">Chapter 4. Xyster_Controller</th>
<td width="20%" align="right"> <a accesskey="n" href="xyster.controller.plugins.html">Next</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="xyster.controller.actionhelpers"></a>4.2. Action Helpers</h2></div></div></div>
<p>These are the Controller Action Helpers included in the Xyster distribution.
				For information about Action Helpers themselves, see the documentation for
				<a href="http://framework.zend.com/manual/en/zend.controller.actionhelpers.html" target="_top">Action Helpers</a>.</p>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="xyster.controller.actionhelpers.cache"></a>4.2.1. Xyster_Controller_Action_Helper_Cache</h3></div></div></div>
<p>It's a pain to have to remember all the HTTP headers associated with Caching responses.
					It's even more of a pain to remember when certain headers don't work (such as certain browsers
					over SSL). The Cache helper aims to alleviate some of these concerns.</p>
<p>It has one method, <code class="methodname">checkModifiedSince</code>, which is also called by the
					direct method of the Helper. Given an integer timestamp, this class compares it to the
					IF_MODIFIED_SINCE header sent by the client. If the client has a date that is equal to the
					one supplied, the helper sends the proper Not-Modified headers, turns off the
		<a href="http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.viewrenderer" target="_top">viewRenderer</a>
					helper, and returns true. If the client has a date older than the one supplied, the helper
					sends the proper cache headers with the date given and returns false.</p>
<p>Here's an example of this class at work in a controller action.</p>
<pre class="programlisting">&lt;?php
public function fooAction()
{
	$myContentWasModified = time();
	if ( $this-&gt;_helper-&gt;Cache($myContentWasModified) ) {
		return;
	}
	// do content construction here...
}</pre>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="xyster.controller.actionhelpers.file"></a>4.2.2. Xyster_Controller_Action_Helper_File</h3></div></div></div>
<p>You know what else is a pain? Dynamic file output to a client. Each client is a little
					different with its gripes about the headers it receives, but this helper should work for most of them.</p>
<p>It has one method, <code class="methodname">setFileHeaders</code>, which is also called by the
					direct method of the helper. You can supply a filename, a MIME type, and a last modified
					integer timestamp of the file (only the filename is required). If the date is specified,
					this helper will in turn call the Cache Helper to send correct headers. This plugin will
					send the headers needed for the content type and filename, but sending the actual body of
					the file and the content length is up to you.</p>
<pre class="programlisting">&lt;?php
public function fooAction()
{
	$filename = '/tmp/somefile.png';
	$myContentWasModified = filemtime($filename);
	if ( $this-&gt;_helper-&gt;File(basename($filename), 'image/png', $myContentWasModified) ) {
		return;
	}
	$this-&gt;getResponse()-&gt;setHeader('Content-Length', filesize($filename))
		-&gt;sendHeaders();
	fpassthru($filename);
}</pre>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="xyster.controller.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="xyster.controller.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="xyster.controller.plugins.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 4. Xyster_Controller </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> 4.3. Plugins</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
